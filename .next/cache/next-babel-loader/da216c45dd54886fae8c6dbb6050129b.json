{"ast":null,"code":"import _regeneratorRuntime from \"/Users/apple/Desktop/mydir/projects/personal/spidy/fe_2/spidy_fe/node_modules/@babel/runtime/regenerator\";\nimport _defineProperty from \"/Users/apple/Desktop/mydir/projects/personal/spidy/fe_2/spidy_fe/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"/Users/apple/Desktop/mydir/projects/personal/spidy/fe_2/spidy_fe/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport axios from 'axios'; // import { getGeoLocation, IP } from './geo-coordinates';\n// eslint-disable-next-line import/no-cycle\n// import { logout } from './logout';\n\nvar _require = require('uuid'),\n    uuidv4 = _require.v4;\n\nexport var timeStamp = new Date().getTime();\nexport var commonHeaders = {\n  destination: 'MOM',\n  source: 'portal',\n  srDate: timeStamp\n};\n/**\n * Create an Axios Client with defaults\n */\n\nvar client = axios.create({\n  baseURL: \"\".concat(process.env.API_URL),\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300; // default\n  }\n});\nexport var uuidGenerator = function uuidGenerator() {\n  return uuidv4().toString(16);\n};\nexport var getCookie = function getCookie(cname) {\n  var name = \"\".concat(cname, \"=\");\n  var ca = document.cookie.split(';');\n\n  for (var i = 0; i < ca.length; i += 1) {\n    var c = ca[i];\n\n    while (c.charAt(0) === ' ') {\n      c = c.substring(1);\n    }\n\n    if (c.indexOf(name) === 0) {\n      return c.substring(name.length, c.length);\n    }\n  }\n\n  return '';\n};\n/**\n * Request Wrapper with default success/error actions\n */\n\nvar request = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(options) {\n    var onSuccess, onError, x, aut, headers, response;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            onSuccess = function onSuccess(response) {\n              /* await axios\n              .post('/logger', response.data.response)\n              .then((res) => res)\n              .catch((err) => err); */\n              return response.data;\n            };\n\n            onError = function onError(error) {\n              var servicerResponse = error && error.response && error.response.data;\n              var errorresponse = servicerResponse && servicerResponse.response;\n\n              if (servicerResponse && error.response.status === 401 && servicerResponse.result && servicerResponse.result.arguments && servicerResponse.result.arguments[0].errorCode === 'INVALID_TOKEN') {//   logout();\n              }\n\n              if (errorresponse && error.response.status === 401 && errorresponse.result && errorresponse.result.arguments && errorresponse.result.arguments[0].errorCode === 'INVALID_TOKEN') {//   logout();\n              }\n\n              if (errorresponse && typeof errorresponse !== 'undefined') {\n                return Promise.reject(errorresponse.result);\n              }\n\n              if (servicerResponse && typeof servicerResponse !== 'undefined') {\n                return Promise.reject(servicerResponse.result);\n              }\n\n              return Promise.reject(error && error || servicerResponse.result);\n            };\n\n            _context.prev = 2;\n            x = getCookie('token');\n            aut = getCookie('userId');\n            headers = _objectSpread({}, options.headers);\n\n            if (x) {\n              headers.token = x;\n            }\n\n            if (aut) {\n              headers.authorization = aut;\n            } // let address = window.localStorage.getItem('address');\n            // if (address === undefined || address === null || address === '') {\n            //   address = await IP();\n            // }\n            // const permission = await navigator.permissions.query({\n            //   name: 'geolocation',\n            // });\n            // if (permission.state !== 'denied') {\n            //   const location = await getGeoLocation();\n            //   if (\n            //     location &&\n            //     Object.prototype.hasOwnProperty.call(location, 'latitude')\n            //   ) {\n            //     headers.latitude = `${location.latitude}`;\n            //     headers.longitude = `${location.longitude}`;\n            //   } else {\n            //     headers.latitude = '';\n            //     headers.longitude = '';\n            //   }\n            // } else {\n            //   headers.latitude = '';\n            //   headers.longitude = '';\n            // }\n            // headers.clientAddress = address;\n\n\n            _context.next = 10;\n            return client(_objectSpread(_objectSpread({}, options), {}, {\n              headers: _objectSpread(_objectSpread(_objectSpread({}, headers), commonHeaders), {}, {\n                correlationId: uuidGenerator()\n              })\n            }));\n\n          case 10:\n            response = _context.sent;\n            return _context.abrupt(\"return\", onSuccess(response));\n\n          case 14:\n            _context.prev = 14;\n            _context.t0 = _context[\"catch\"](2);\n            return _context.abrupt(\"return\", onError(_context.t0));\n\n          case 17:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[2, 14]]);\n  }));\n\n  return function request(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nexport default request;","map":{"version":3,"sources":["/Users/apple/Desktop/mydir/projects/personal/spidy/fe_2/spidy_fe/app/lib/utility/apiWrapper.js"],"names":["axios","require","uuidv4","v4","timeStamp","Date","getTime","commonHeaders","destination","source","srDate","client","create","baseURL","process","env","API_URL","validateStatus","status","uuidGenerator","toString","getCookie","cname","name","ca","document","cookie","split","i","length","c","charAt","substring","indexOf","request","options","onSuccess","response","data","onError","error","servicerResponse","errorresponse","result","arguments","errorCode","Promise","reject","x","aut","headers","token","authorization","correlationId"],"mappings":"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","sourcesContent":["import axios from 'axios';\n\n// import { getGeoLocation, IP } from './geo-coordinates';\n// eslint-disable-next-line import/no-cycle\n// import { logout } from './logout';\n\nconst { v4: uuidv4 } = require('uuid');\n\nexport const timeStamp = new Date().getTime();\nexport const commonHeaders = {\n  destination: 'MOM',\n  source: 'portal',\n  srDate: timeStamp,\n};\n/**\n * Create an Axios Client with defaults\n */\nconst client = axios.create({\n  baseURL: `${process.env.API_URL}`,\n  validateStatus: (status) => {\n    return status >= 200 && status < 300; // default\n  },\n});\nexport const uuidGenerator = () => {\n  return uuidv4().toString(16);\n};\nexport const getCookie = (cname) => {\n  const name = `${cname}=`;\n  const ca = document.cookie.split(';');\n  for (let i = 0; i < ca.length; i += 1) {\n    let c = ca[i];\n    while (c.charAt(0) === ' ') {\n      c = c.substring(1);\n    }\n    if (c.indexOf(name) === 0) {\n      return c.substring(name.length, c.length);\n    }\n  }\n  return '';\n};\n\n/**\n * Request Wrapper with default success/error actions\n */\n\nconst request = async (options) => {\n  const onSuccess = (response) => {\n    /* await axios\n.post('/logger', response.data.response)\n.then((res) => res)\n.catch((err) => err); */\n    return response.data;\n  };\n\n  const onError = (error) => {\n    const servicerResponse = error && error.response && error.response.data;\n    const errorresponse = servicerResponse && servicerResponse.response;\n    if (\n      servicerResponse &&\n      error.response.status === 401 &&\n      servicerResponse.result &&\n      servicerResponse.result.arguments &&\n      servicerResponse.result.arguments[0].errorCode === 'INVALID_TOKEN'\n    ) {\n    //   logout();\n    }\n    if (\n      errorresponse &&\n      error.response.status === 401 &&\n      errorresponse.result &&\n      errorresponse.result.arguments &&\n      errorresponse.result.arguments[0].errorCode === 'INVALID_TOKEN'\n    ) {\n    //   logout();\n    }\n    if (errorresponse && typeof errorresponse !== 'undefined') {\n      return Promise.reject(errorresponse.result);\n    }\n    if (servicerResponse && typeof servicerResponse !== 'undefined') {\n      return Promise.reject(servicerResponse.result);\n    }\n    return Promise.reject((error && error) || servicerResponse.result);\n  };\n  try {\n    const x = getCookie('token');\n    const aut = getCookie('userId')\n    const headers = { ...options.headers };\n    if (x) {\n      headers.token = x;\n    }\n    if(aut){\n      headers.authorization = aut;\n    }\n    // let address = window.localStorage.getItem('address');\n    // if (address === undefined || address === null || address === '') {\n    //   address = await IP();\n    // }\n    // const permission = await navigator.permissions.query({\n    //   name: 'geolocation',\n    // });\n    // if (permission.state !== 'denied') {\n    //   const location = await getGeoLocation();\n    //   if (\n    //     location &&\n    //     Object.prototype.hasOwnProperty.call(location, 'latitude')\n    //   ) {\n    //     headers.latitude = `${location.latitude}`;\n    //     headers.longitude = `${location.longitude}`;\n    //   } else {\n    //     headers.latitude = '';\n    //     headers.longitude = '';\n    //   }\n    // } else {\n    //   headers.latitude = '';\n    //   headers.longitude = '';\n    // }\n    // headers.clientAddress = address;\n    const response = await client({\n      ...options,\n      headers: { ...headers, ...commonHeaders, correlationId: uuidGenerator() },\n    });\n    return onSuccess(response);\n  } catch (error) {\n    return onError(error);\n  }\n};\n\nexport default request;\n"]},"metadata":{},"sourceType":"module"}