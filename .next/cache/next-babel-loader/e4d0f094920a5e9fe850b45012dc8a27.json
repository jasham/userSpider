{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport axios from 'axios'; // import { getGeoLocation, IP } from './geo-coordinates';\n// eslint-disable-next-line import/no-cycle\n// import { logout } from './logout';\n\nconst {\n  v4: uuidv4\n} = require('uuid');\n\nexport const timeStamp = new Date().getTime();\nexport const commonHeaders = {\n  destination: 'MOM',\n  source: 'portal',\n  srDate: timeStamp\n};\n/**\n * Create an Axios Client with defaults\n */\n\nconst client = axios.create({\n  baseURL: `${process.env.API_URL}`\n});\nexport const uuidGenerator = () => uuidv4().toString(16);\nexport const getCookie = cname => {\n  const name = `${cname}=`;\n  const ca = document.cookie.split(';');\n\n  for (let i = 0; i < ca.length; i += 1) {\n    let c = ca[i];\n\n    while (c.charAt(0) === ' ') {\n      c = c.substring(1);\n    }\n\n    if (c.indexOf(name) === 0) {\n      return c.substring(name.length, c.length);\n    }\n  }\n\n  return '';\n};\n/**\n * Request Wrapper with default success/error actions\n */\n\nconst request = async options => {\n  const onSuccess = response =>\n  /* await axios\n  .post('/logger', response.data.response)\n  .then((res) => res)\n  .catch((err) => err); */\n  response.data;\n\n  const onError = error => {\n    const servicerResponse = error && error.response && error.response.data;\n    const errorresponse = servicerResponse && servicerResponse.response;\n\n    if (servicerResponse && error.response.status === 401 && servicerResponse.result && servicerResponse.result.arguments && servicerResponse.result.arguments[0].errorCode === 'INVALID_TOKEN') {//   logout();\n    }\n\n    if (errorresponse && error.response.status === 401 && errorresponse.result && errorresponse.result.arguments && errorresponse.result.arguments[0].errorCode === 'INVALID_TOKEN') {//   logout();\n    }\n\n    if (errorresponse && typeof errorresponse !== 'undefined') {\n      return Promise.reject(errorresponse.result);\n    }\n\n    if (servicerResponse && typeof servicerResponse !== 'undefined') {\n      return Promise.reject(servicerResponse.result);\n    }\n\n    return Promise.reject(error && error || servicerResponse.result);\n  };\n\n  try {\n    const x = getCookie('token');\n    const userId = getCookie('user_id');\n    const uid = getCookie('uid');\n\n    const headers = _objectSpread({}, options.headers);\n\n    if (x) {\n      headers.token = x;\n      headers.authorization = `Bearer ${x}`;\n      headers.user_id = userId;\n      headers.uid = uid;\n    } // let address = window.localStorage.getItem('address');\n    // if (address === undefined || address === null || address === '') {\n    //   address = await IP();\n    // }\n    // const permission = await navigator.permissions.query({\n    //   name: 'geolocation',\n    // });\n    // if (permission.state !== 'denied') {\n    //   const location = await getGeoLocation();\n    //   if (\n    //     location &&\n    //     Object.prototype.hasOwnProperty.call(location, 'latitude')\n    //   ) {\n    //     headers.latitude = `${location.latitude}`;\n    //     headers.longitude = `${location.longitude}`;\n    //   } else {\n    //     headers.latitude = '';\n    //     headers.longitude = '';\n    //   }\n    // } else {\n    //   headers.latitude = '';\n    //   headers.longitude = '';\n    // }\n    // headers.clientAddress = address;\n\n\n    const response = await client(_objectSpread(_objectSpread({}, options), {}, {\n      headers: _objectSpread(_objectSpread(_objectSpread({}, headers), commonHeaders), {}, {\n        correlationId: uuidGenerator()\n      })\n    }));\n    return onSuccess(response);\n  } catch (error) {\n    return onError(error);\n  }\n};\n\nexport default request;","map":{"version":3,"sources":["/Users/apple/Desktop/mydir/projects/personal/spidy/fe_2/spidy_fe/app/lib/utility/apiWrapper.js"],"names":["axios","v4","uuidv4","require","timeStamp","Date","getTime","commonHeaders","destination","source","srDate","client","create","baseURL","process","env","API_URL","uuidGenerator","toString","getCookie","cname","name","ca","document","cookie","split","i","length","c","charAt","substring","indexOf","request","options","onSuccess","response","data","onError","error","servicerResponse","errorresponse","status","result","arguments","errorCode","Promise","reject","x","userId","uid","headers","token","authorization","user_id","correlationId"],"mappings":"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","sourcesContent":["import axios from 'axios';\n\n// import { getGeoLocation, IP } from './geo-coordinates';\n// eslint-disable-next-line import/no-cycle\n// import { logout } from './logout';\n\nconst { v4: uuidv4 } = require('uuid');\n\nexport const timeStamp = new Date().getTime();\nexport const commonHeaders = {\n  destination: 'MOM',\n  source: 'portal',\n  srDate: timeStamp,\n};\n/**\n * Create an Axios Client with defaults\n */\nconst client = axios.create({\n  baseURL: `${process.env.API_URL}`,\n});\nexport const uuidGenerator = () => uuidv4().toString(16);\nexport const getCookie = (cname) => {\n  const name = `${cname}=`;\n  const ca = document.cookie.split(';');\n  for (let i = 0; i < ca.length; i += 1) {\n    let c = ca[i];\n    while (c.charAt(0) === ' ') {\n      c = c.substring(1);\n    }\n    if (c.indexOf(name) === 0) {\n      return c.substring(name.length, c.length);\n    }\n  }\n  return '';\n};\n\n/**\n * Request Wrapper with default success/error actions\n */\n\nconst request = async (options) => {\n  const onSuccess = (response) =>\n    /* await axios\n.post('/logger', response.data.response)\n.then((res) => res)\n.catch((err) => err); */\n    response.data;\n  const onError = (error) => {\n    const servicerResponse = error && error.response && error.response.data;\n    const errorresponse = servicerResponse && servicerResponse.response;\n    if (\n      servicerResponse &&\n      error.response.status === 401 &&\n      servicerResponse.result &&\n      servicerResponse.result.arguments &&\n      servicerResponse.result.arguments[0].errorCode === 'INVALID_TOKEN'\n    ) {\n      //   logout();\n    }\n    if (\n      errorresponse &&\n      error.response.status === 401 &&\n      errorresponse.result &&\n      errorresponse.result.arguments &&\n      errorresponse.result.arguments[0].errorCode === 'INVALID_TOKEN'\n    ) {\n      //   logout();\n    }\n    if (errorresponse && typeof errorresponse !== 'undefined') {\n      return Promise.reject(errorresponse.result);\n    }\n    if (servicerResponse && typeof servicerResponse !== 'undefined') {\n      return Promise.reject(servicerResponse.result);\n    }\n    return Promise.reject((error && error) || servicerResponse.result);\n  };\n  try {\n    const x = getCookie('token');\n    const userId = getCookie('user_id');\n    const uid = getCookie('uid');\n    const headers = { ...options.headers };\n    if (x) {\n      headers.token = x;\n      headers.authorization = `Bearer ${x}`;\n      headers.user_id = userId;\n      headers.uid = uid;\n    }\n\n    // let address = window.localStorage.getItem('address');\n    // if (address === undefined || address === null || address === '') {\n    //   address = await IP();\n    // }\n    // const permission = await navigator.permissions.query({\n    //   name: 'geolocation',\n    // });\n    // if (permission.state !== 'denied') {\n    //   const location = await getGeoLocation();\n    //   if (\n    //     location &&\n    //     Object.prototype.hasOwnProperty.call(location, 'latitude')\n    //   ) {\n    //     headers.latitude = `${location.latitude}`;\n    //     headers.longitude = `${location.longitude}`;\n    //   } else {\n    //     headers.latitude = '';\n    //     headers.longitude = '';\n    //   }\n    // } else {\n    //   headers.latitude = '';\n    //   headers.longitude = '';\n    // }\n    // headers.clientAddress = address;\n    const response = await client({\n      ...options,\n      headers: { ...headers, ...commonHeaders, correlationId: uuidGenerator() },\n    });\n    return onSuccess(response);\n  } catch (error) {\n    return onError(error);\n  }\n};\n\nexport default request;\n"]},"metadata":{},"sourceType":"module"}