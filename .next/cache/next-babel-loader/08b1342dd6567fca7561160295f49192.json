{"ast":null,"code":"import _Dialog from \"@material-ui/core/Dialog\";\nimport _DialogActions from \"@material-ui/core/DialogActions\";\nimport _Button from \"@material-ui/core/Button\";\nimport _DialogContent from \"@material-ui/core/DialogContent\";\nimport _Box from \"@material-ui/core/Box\";\nimport _TextField from \"@material-ui/core/TextField\";\nimport _DialogContentText from \"@material-ui/core/DialogContentText\";\nimport _DialogTitle from \"@material-ui/core/DialogTitle\";\nimport _regeneratorRuntime from \"/Users/apple/Desktop/mydir/projects/personal/spidy/fe_2/spidy_fe/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/apple/Desktop/mydir/projects/personal/spidy/fe_2/spidy_fe/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/apple/Desktop/mydir/projects/personal/spidy/fe_2/spidy_fe/app/components/loginModal/index.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState } from 'react';\nimport { withStyles } from '@material-ui/core/styles';\nimport PropTypes from 'prop-types';\nimport Link from '../link';\nimport { GlobalContext } from '../../../pages/_app';\nimport { LOGIN_MODAL_STATUS, SIGN_UP_MODAL_STATUS, ALERT_DIALOG, ERROR_TITLE, ERROR_DESCRIPTION, AUTH_STATUS } from '../../lib/utility/type';\nimport AlertDialog from '../alert';\nimport { validateEmail } from '../../lib/utility/common';\nimport request from '../../lib/utility/apiWrapper';\nimport { login } from '../../lib/services/login';\n\nvar styles = function styles() {\n  return {\n    root: {},\n    textField: {\n      marginBottom: 20\n    },\n    linkWrapper: {\n      display: 'flex',\n      flexDirection: 'row'\n    },\n    linkButton: {\n      marginRight: 20\n    }\n  };\n};\n\nvar Login = function Login(_ref) {\n  _s();\n\n  var classes = _ref.classes,\n      open = _ref.open,\n      handleClose = _ref.handleClose;\n\n  var _useState = useState(null),\n      email = _useState[0],\n      setEmail = _useState[1];\n\n  var _useState2 = useState(null),\n      password = _useState2[0],\n      setPassword = _useState2[1];\n\n  var globalContext = useContext(GlobalContext);\n\n  var errorFunc = function errorFunc(title, description) {\n    globalContext.allDispatch({\n      type: ERROR_DESCRIPTION,\n      value: description\n    });\n    globalContext.allDispatch({\n      type: ERROR_TITLE,\n      value: title\n    });\n    globalContext.allDispatch({\n      type: ALERT_DIALOG,\n      value: true\n    });\n  };\n\n  var onSignUp = function onSignUp() {\n    globalContext.allDispatch({\n      type: SIGN_UP_MODAL_STATUS,\n      value: true\n    });\n    globalContext.allDispatch({\n      type: LOGIN_MODAL_STATUS,\n      value: false\n    });\n  };\n\n  var login = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(data) {\n      var loginData;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return request({\n                url: '/userlogin',\n                method: 'post',\n                data: data\n              }).then(function (res) {\n                if (res.result === 'success') {\n                  document.cookie = \"token=\".concat(res.data.token);\n                  document.cookie = \"user_id=\".concat(res.data.user_id);\n                  document.cookie = \"uid=\".concat(res.data.uid);\n                  globalContext.allDispatch({\n                    type: AUTH_STATUS,\n                    value: true\n                  });\n                  globalContext.allDispatch({\n                    type: LOGIN_MODAL_STATUS,\n                    value: false\n                  });\n                } else if (loginData.result === 'wrongEmail') {\n                  globalContext.allDispatch({\n                    type: ERROR_DESCRIPTION,\n                    value: 'Please enter correct email.'\n                  });\n                  globalContext.allDispatch({\n                    type: ERROR_TITLE,\n                    value: 'Wrong credentials.'\n                  });\n                  globalContext.allDispatch({\n                    type: ALERT_DIALOG,\n                    value: true\n                  });\n                } else if (loginData.result === 'wrongPassword') {\n                  globalContext.allDispatch({\n                    type: ERROR_DESCRIPTION,\n                    value: 'Please enter correct password.'\n                  });\n                  globalContext.allDispatch({\n                    type: ERROR_TITLE,\n                    value: 'Wrong credentials.'\n                  });\n                  globalContext.allDispatch({\n                    type: ALERT_DIALOG,\n                    value: true\n                  });\n                }\n              });\n\n            case 2:\n              loginData = _context.sent;\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function login(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var onSubmit = function onSubmit() {\n    if (email && password) {\n      if (validateEmail(email)) {\n        if (password.length > 7) {\n          var temp = {\n            emailOrMobile: email,\n            password: password\n          };\n          login(temp);\n        } else {\n          errorFunc('Incorrect Password', 'Minimum password length is 8 charachters.');\n        }\n      } else {\n        errorFunc('Incorrect Email', 'Please enter correct email and try again.');\n      }\n    } else {\n      errorFunc('Missing Fields', 'Please enter all mandatory fields.');\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(_Dialog, {\n      open: open,\n      onClose: handleClose,\n      fullWidth: true,\n      maxWidth: \"sm\",\n      \"aria-labelledby\": \"form-dialog-title\",\n      children: [/*#__PURE__*/_jsxDEV(_DialogTitle, {\n        id: \"form-dialog-title\",\n        children: \"Login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(_DialogContent, {\n        children: [/*#__PURE__*/_jsxDEV(_DialogContentText, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(_Box, {\n          className: classes.textField,\n          children: /*#__PURE__*/_jsxDEV(_TextField, {\n            id: \"email\",\n            label: \"Email Address\",\n            type: \"email\",\n            fullWidth: true,\n            variant: \"outlined\",\n            value: email,\n            onChange: function onChange(e) {\n              return setEmail(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(_Box, {\n          className: classes.textField,\n          children: /*#__PURE__*/_jsxDEV(_TextField, {\n            id: \"password\",\n            label: \"Password\",\n            type: \"password\",\n            fullWidth: true,\n            variant: \"outlined\",\n            value: password,\n            onChange: function onChange(e) {\n              return setPassword(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(_Box, {\n          className: classes.linkWrapper,\n          children: [/*#__PURE__*/_jsxDEV(_Box, {\n            className: classes.linkButton,\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              href: \"#\",\n              children: \"Forgot Password\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(_Box, {\n            className: classes.linkButton,\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              href: \"#\",\n              onClick: onSignUp,\n              children: \"Don't have account! Sign Up\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(_DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(_Button, {\n          onClick: onSubmit,\n          color: \"primary\",\n          children: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(_Button, {\n          onClick: handleClose,\n          color: \"primary\",\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(AlertDialog, {\n      open: globalContext.state.alertStatus,\n      title: globalContext.state.errorTitle,\n      description: globalContext.state.errorDescription\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 151,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(Login, \"1xm6th5WqO4Ctmo1VMCcWwd6L2A=\");\n\n_c = Login;\nLogin.propTypes = {\n  open: PropTypes.bool,\n  handleClose: PropTypes.func\n};\nexport default withStyles(styles)(Login);\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/Users/apple/Desktop/mydir/projects/personal/spidy/fe_2/spidy_fe/app/components/loginModal/index.js"],"names":["React","useContext","useState","withStyles","PropTypes","Link","GlobalContext","LOGIN_MODAL_STATUS","SIGN_UP_MODAL_STATUS","ALERT_DIALOG","ERROR_TITLE","ERROR_DESCRIPTION","AUTH_STATUS","AlertDialog","validateEmail","request","login","styles","root","textField","marginBottom","linkWrapper","display","flexDirection","linkButton","marginRight","Login","classes","open","handleClose","email","setEmail","password","setPassword","globalContext","errorFunc","title","description","allDispatch","type","value","onSignUp","data","url","method","then","res","result","document","cookie","token","user_id","uid","loginData","onSubmit","length","temp","emailOrMobile","e","target","state","alertStatus","errorTitle","errorDescription","propTypes","bool","func"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from 'react';\nimport {\n  Box,\n  Button,\n  TextField,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n} from '@material-ui/core';\nimport { withStyles } from '@material-ui/core/styles';\nimport PropTypes from 'prop-types';\nimport Link from '../link';\nimport { GlobalContext } from '../../../pages/_app';\nimport {\n  LOGIN_MODAL_STATUS,\n  SIGN_UP_MODAL_STATUS,\n  ALERT_DIALOG,\n  ERROR_TITLE,\n  ERROR_DESCRIPTION,\n  AUTH_STATUS,\n} from '../../lib/utility/type';\nimport AlertDialog from '../alert';\nimport { validateEmail } from '../../lib/utility/common';\nimport request from '../../lib/utility/apiWrapper';\n\nimport { login } from '../../lib/services/login';\n\nconst styles = () => ({\n  root: {},\n  textField: {\n    marginBottom: 20,\n  },\n  linkWrapper: {\n    display: 'flex',\n    flexDirection: 'row',\n  },\n  linkButton: {\n    marginRight: 20,\n  },\n});\n\nconst Login = ({ classes, open, handleClose }) => {\n  const [email, setEmail] = useState(null);\n  const [password, setPassword] = useState(null);\n\n  const globalContext = useContext(GlobalContext);\n\n  const errorFunc = (title, description) => {\n    globalContext.allDispatch({\n      type: ERROR_DESCRIPTION,\n      value: description,\n    });\n    globalContext.allDispatch({\n      type: ERROR_TITLE,\n      value: title,\n    });\n    globalContext.allDispatch({\n      type: ALERT_DIALOG,\n      value: true,\n    });\n  };\n\n  const onSignUp = () => {\n    globalContext.allDispatch({\n      type: SIGN_UP_MODAL_STATUS,\n      value: true,\n    });\n    globalContext.allDispatch({\n      type: LOGIN_MODAL_STATUS,\n      value: false,\n    });\n  };\n\n  const login = async (data) => {\n    const loginData = await request({\n      url: '/userlogin',\n      method: 'post',\n      data,\n    }).then((res) => {\n      if (res.result === 'success') {\n        document.cookie = `token=${res.data.token}`;\n        document.cookie = `user_id=${res.data.user_id}`;\n        document.cookie = `uid=${res.data.uid}`;\n        globalContext.allDispatch({\n          type: AUTH_STATUS,\n          value: true,\n        });\n        globalContext.allDispatch({\n          type: LOGIN_MODAL_STATUS,\n          value: false,\n        });\n      } else if (loginData.result === 'wrongEmail') {\n        globalContext.allDispatch({\n          type: ERROR_DESCRIPTION,\n          value: 'Please enter correct email.',\n        });\n        globalContext.allDispatch({\n          type: ERROR_TITLE,\n          value: 'Wrong credentials.',\n        });\n        globalContext.allDispatch({\n          type: ALERT_DIALOG,\n          value: true,\n        });\n      } else if (loginData.result === 'wrongPassword') {\n        globalContext.allDispatch({\n          type: ERROR_DESCRIPTION,\n          value: 'Please enter correct password.',\n        });\n        globalContext.allDispatch({\n          type: ERROR_TITLE,\n          value: 'Wrong credentials.',\n        });\n        globalContext.allDispatch({\n          type: ALERT_DIALOG,\n          value: true,\n        });\n      }\n    });\n  };\n\n  const onSubmit = () => {\n    if (email && password) {\n      if (validateEmail(email)) {\n        if (password.length > 7) {\n          const temp = {\n            emailOrMobile: email,\n            password,\n          };\n          login(temp);\n        } else {\n          errorFunc(\n            'Incorrect Password',\n            'Minimum password length is 8 charachters.',\n          );\n        }\n      } else {\n        errorFunc(\n          'Incorrect Email',\n          'Please enter correct email and try again.',\n        );\n      }\n    } else {\n      errorFunc('Missing Fields', 'Please enter all mandatory fields.');\n    }\n  };\n\n  return (\n    <div>\n      <Dialog\n        open={open}\n        onClose={handleClose}\n        fullWidth\n        maxWidth=\"sm\"\n        aria-labelledby=\"form-dialog-title\"\n      >\n        <DialogTitle id=\"form-dialog-title\">Login</DialogTitle>\n        <DialogContent>\n          <DialogContentText />\n          <Box className={classes.textField}>\n            <TextField\n              id=\"email\"\n              label=\"Email Address\"\n              type=\"email\"\n              fullWidth\n              variant=\"outlined\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n            />\n          </Box>\n          <Box className={classes.textField}>\n            <TextField\n              id=\"password\"\n              label=\"Password\"\n              type=\"password\"\n              fullWidth\n              variant=\"outlined\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n            />\n          </Box>\n          <Box className={classes.linkWrapper}>\n            <Box className={classes.linkButton}>\n              <Link href=\"#\">Forgot Password</Link>\n            </Box>\n            <Box className={classes.linkButton}>\n              <Link href=\"#\" onClick={onSignUp}>\n                Don&apos;t have account! Sign Up\n              </Link>\n            </Box>\n          </Box>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={onSubmit} color=\"primary\">\n            Submit\n          </Button>\n          <Button onClick={handleClose} color=\"primary\">\n            Cancel\n          </Button>\n        </DialogActions>\n      </Dialog>\n      <AlertDialog\n        open={globalContext.state.alertStatus}\n        title={globalContext.state.errorTitle}\n        description={globalContext.state.errorDescription}\n      />\n    </div>\n  );\n};\n\nLogin.propTypes = {\n  open: PropTypes.bool,\n  handleClose: PropTypes.func,\n};\n\nexport default withStyles(styles)(Login);\n"]},"metadata":{},"sourceType":"module"}